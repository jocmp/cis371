<html>
<head>
	<title>week 7 example</title>

	<script language = "javascript">

		function loadDoc(fileName){
			if (window.XMLHttpRequest)
			  obj=new XMLHttpRequest();
			else
			  obj=new ActiveXObject("Microsoft.XMLHTTP");
			obj.open("GET",fileName,false);
			obj.send("");
			return obj.responseXML;
		}

		function getNames(){
			xml=loadDoc("week6a.xml");
			xsl=loadDoc("week6a.xsl");
			if (window.ActiveXObject){
			  ex=xml.transformNode(xsl);
			  document.getElementById("targetDiv").innerHTML=ex;
		  }else if (document.implementation && document.implementation.createDocument){
			  xsltProcessor=new XSLTProcessor();
			  xsltProcessor.importStylesheet(xsl);
			  resultDocument = xsltProcessor.transformToFragment(xml,document);
			  document.getElementById("targetDiv").appendChild(resultDocument);
		  }
		}

  </script>
</head>
<body>
	<H1>An Ajax demo</H1>
  <form>
		<input type = "button" value = "Get student names" onclick = "getNames()">
  </form>

	<div id="targetDiv">
	</div>

</body>
</html>
